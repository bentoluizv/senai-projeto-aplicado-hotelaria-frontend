---
import { verifyToken } from "../lib/auth";
import Layout from "./Layout.astro";

const token = Astro.cookies.get("token")?.value;
const verification = await verifyToken(token);

if (!verification.isValid) {
  return Astro.redirect("/login");
}
---

<Layout title="Protected Page">
  <slot />
</Layout>
